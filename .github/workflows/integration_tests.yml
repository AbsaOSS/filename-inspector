name: Integration Tests

on:
  pull_request:

jobs:
  determine-branch:
    runs-on: ubuntu-latest

    outputs:
      branch: ${{ steps.get-branch.outputs.branch }}

    steps:
      - name: Checkout code
        uses: actions/checkout@v4.1.7

      - name: Get current branch
        id: get-branch
        run: echo "::set-output name=branch::$(git rev-parse --abbrev-ref HEAD)"

  run-tests:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4.1.7

      - name: Execute unit tests
        run: |
          pytest --cov=src --cov-report html tests/

      - name: Test 1 - Filename Inspector Default
        id: test_1
        uses: AbsaOSS/filename-inspector@${{ needs.determine-branch.outputs.branch }}
        with:
          name-patterns: '*UnitTest.*,*IntegrationTest.*'
          paths: '**/src/test/java/**,**/src/test/scala/**'
